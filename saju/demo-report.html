<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>ì‚¬ì£¼ ë¦¬í¬íŠ¸ | AI ì‚¬ì£¼ Ã— MBTI</title>
    <meta name="description" content="AI ì‚¬ì£¼ Ã— MBTI ìƒì„¸ ë¦¬í¬íŠ¸. ì‚¬ì£¼íŒ”ì(ì—°/ì›”/ì¼/ì‹œ), ì˜¤í–‰ ë°¸ëŸ°ìŠ¤, ìš©ì‹ /ê¸°ì‹ , ì‹­ì‹ , MBTI ìœµí•©ê¹Œì§€ í•œ ë²ˆì—." />
    <meta name="robots" content="noindex,follow" />
    <link rel="canonical" href="https://im7873384-wq.github.io/jaehong-lotto/saju/" />

    <meta property="og:type" content="website" />
    <meta property="og:site_name" content="ì¬í™ ì‚¬ì£¼" />
    <meta property="og:title" content="ì‚¬ì£¼ ë¦¬í¬íŠ¸ | AI ì‚¬ì£¼ Ã— MBTI" />
    <meta property="og:description" content="ì‚¬ì£¼íŒ”ì/ì˜¤í–‰/ìš©ì‹ /ì‹­ì‹ /MBTIë¥¼ â€˜ì‰½ê²Œâ€™ ì •ë¦¬í•œ ë¦¬í¬íŠ¸." />
    <meta property="og:url" content="https://im7873384-wq.github.io/jaehong-lotto/saju/" />
    <meta property="og:image" content="https://im7873384-wq.github.io/jaehong-lotto/og/og-saju.svg" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="ì‚¬ì£¼ ë¦¬í¬íŠ¸ | AI ì‚¬ì£¼ Ã— MBTI" />
    <meta name="twitter:description" content="ì‚¬ì£¼íŒ”ì/ì˜¤í–‰/ìš©ì‹ /ì‹­ì‹ /MBTIë¥¼ â€˜ì‰½ê²Œâ€™ ì •ë¦¬í•œ ë¦¬í¬íŠ¸." />
    <meta name="twitter:image" content="https://im7873384-wq.github.io/jaehong-lotto/og/og-saju.svg" />

    <link rel="stylesheet" href="../nav.css">

    <!-- ì‚¬ì£¼ ì—”ì§„ ë¡œë“œ -->
    <script src="saju-engine.js"></script>
    <script src="personal-analysis.js"></script>

    <!-- ì¶”ê°€ ì—”ì§„ ì•ˆì „ ë¡œë“œ -->
    <script>
    (function() {
        const additionalScripts = [
            'enhanced-saju-engine.js',
            'professional-analysis.js'
        ];
        
        additionalScripts.forEach(scriptSrc => {
            try {
                const script = document.createElement('script');
                script.src = scriptSrc;
                script.onerror = function() {
                    console.warn(scriptSrc + ' ë¡œë“œ ì‹¤íŒ¨ - ê¸°ë³¸ ê¸°ëŠ¥ìœ¼ë¡œ ë™ì‘');
                };
                document.head.appendChild(script);
            } catch (e) {
                console.warn(scriptSrc + ' ë¡œë“œ ì¤‘ ì˜¤ë¥˜:', e);
            }
        });
    })();
    </script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Apple SD Gothic Neo', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Noto Sans KR', sans-serif; 
            line-height: 1.7; 
            background: #f7f8fc; 
            color: #2c3e50;
        }

        .container { 
            max-width: 900px; 
            margin: 0 auto; 
            padding: 30px 20px; 
        }

        /* í—¤ë” */
        .report-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(102, 126, 234, 0.3);
        }

        .report-header h1 {
            font-size: 1.8rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .report-header .user-info {
            font-size: 1.1rem;
            opacity: 0.95;
            margin-bottom: 20px;
        }

        .score-display {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .score-item {
            background: rgba(255,255,255,0.15);
            padding: 15px 25px;
            border-radius: 12px;
            text-align: center;
            min-width: 100px;
        }

        .score-item .label {
            font-size: 0.85rem;
            opacity: 0.9;
            margin-bottom: 5px;
        }

        .score-item .value {
            font-size: 1.8rem;
            font-weight: 800;
        }

        /* ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: white;
            padding: 25px;
            border-radius: 16px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            border-left: 4px solid;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        }

        .card h3 {
            font-size: 1rem;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .card-score {
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 8px;
        }

        .card-trend {
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .card-desc {
            color: #6b7280;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .card.love { border-left-color: #ef4444; }
        .card.love h3, .card.love .card-score { color: #dc2626; }

        .card.career { border-left-color: #3b82f6; }
        .card.career h3, .card.career .card-score { color: #2563eb; }

        .card.wealth { border-left-color: #eab308; }
        .card.wealth h3, .card.wealth .card-score { color: #ca8a04; }

        .card.health { border-left-color: #22c55e; }
        .card.health h3, .card.health .card-score { color: #16a34a; }

        .trend-up { color: #059669; }
        .trend-stable { color: #6b7280; }
        .trend-down { color: #dc2626; }

        /* ë¶„ì„ ì„¹ì…˜ */
        .analysis-section {
            background: white;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            margin-bottom: 25px;
        }

        .analysis-section h3 {
            color: #667eea;
            font-size: 1.3rem;
            margin-bottom: 20px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .analysis-section p {
            color: #4b5563;
            line-height: 1.8;
            margin-bottom: 15px;
        }

        .analysis-section ul {
            margin: 15px 0;
            padding-left: 20px;
        }

        .analysis-section li {
            margin-bottom: 8px;
            color: #4b5563;
        }

        /* ì‚¬ì£¼íŒ”ì í‘œì‹œ */
        .saju-display {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .pillar {
            background: #f8fafc;
            padding: 20px 15px;
            border-radius: 12px;
            text-align: center;
            border: 2px solid #e5e7eb;
        }

        .pillar-title {
            font-size: 0.85rem;
            color: #6b7280;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .pillar-chinese {
            font-size: 1.8rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 5px;
        }

        .pillar-korean {
            font-size: 0.9rem;
            color: #4b5563;
        }

        /* ì˜¤í–‰ ë°” */
        .element-bars {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 12px;
            margin: 20px 0;
        }

        .element-bar {
            text-align: center;
        }

        .element-bar .label {
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 0.95rem;
        }

        .element-bar .bar-container {
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
        }

        .element-bar .bar-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .element-bar .percentage {
            font-size: 0.8rem;
            color: #6b7280;
            margin-top: 5px;
        }

        .element-wood .label { color: #059669; }
        .element-wood .bar-fill { background: #059669; }
        .element-fire .label { color: #dc2626; }
        .element-fire .bar-fill { background: #dc2626; }
        .element-earth .label { color: #d97706; }
        .element-earth .bar-fill { background: #d97706; }
        .element-metal .label { color: #6b7280; }
        .element-metal .bar-fill { background: #6b7280; }
        .element-water .label { color: #0ea5e9; }
        .element-water .bar-fill { background: #0ea5e9; }

        /* ì¡°ì–¸ ê·¸ë¦¬ë“œ */
        .advice-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 15px;
        }

        .advice-card {
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid;
        }

        .advice-card h4 {
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .advice-card p {
            font-size: 0.9rem;
            line-height: 1.5;
            color: #4b5563;
            margin: 0;
        }

        .advice-love { background: #fef2f2; border-left-color: #ef4444; }
        .advice-love h4 { color: #dc2626; }

        .advice-career { background: #eff6ff; border-left-color: #3b82f6; }
        .advice-career h4 { color: #2563eb; }

        .advice-wealth { background: #fefce8; border-left-color: #eab308; }
        .advice-wealth h4 { color: #ca8a04; }

        .advice-health { background: #f0fdf4; border-left-color: #22c55e; }
        .advice-health h4 { color: #16a34a; }

        /* ë²„íŠ¼ */
        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 40px 0 20px;
        }

        .btn {
            padding: 14px 28px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
        }

        .btn-secondary:hover {
            background: #667eea;
            color: white;
        }

        /* í‘¸í„° */
        .footer {
            text-align: center;
            padding: 30px;
            color: #9ca3af;
            font-size: 0.85rem;
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .container { padding: 20px 15px; }
            .report-header { padding: 30px 20px; }
            .report-header h1 { font-size: 1.5rem; }
            .cards-grid { grid-template-columns: 1fr 1fr; }
            .saju-display { grid-template-columns: repeat(2, 1fr); }
            .element-bars { grid-template-columns: repeat(5, 1fr); gap: 8px; }
            .element-bar .label { font-size: 0.8rem; }
            .analysis-section { padding: 20px; }
            .advice-grid { grid-template-columns: 1fr; }
        }

        @media (max-width: 480px) {
            .cards-grid { grid-template-columns: 1fr; }
            .score-display { flex-direction: column; align-items: center; }
        }

        /* ì• ë‹ˆë©”ì´ì…˜ */
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ë¡œë”© */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255,255,255,0.95);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #e5e7eb;
            border-top-color: #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-text {
            margin-top: 20px;
            font-size: 1.1rem;
            color: #4b5563;
        }
    </style>
</head>
<body>
    <nav class="top-nav">
        <a href="/jaehong-lotto/">í™ˆ</a>
        <a href="/jaehong-lotto/lotto/">ë¡œë˜</a>
        <a href="/jaehong-lotto/saju/">ì‚¬ì£¼</a>
    </nav>

    <!-- ë¡œë”© ì˜¤ë²„ë ˆì´ -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner"></div>
        <p class="loading-text">ğŸ”® ì‚¬ì£¼ ë¶„ì„ ì¤‘...</p>
    </div>

    <div class="container" id="mainContent" style="display: none;">
        <!-- í—¤ë” -->
        <div class="report-header fade-in">
            <h1 id="reportTitle">ì‚¬ì£¼ ë¶„ì„ ê²°ê³¼</h1>
            <p class="user-info" id="userInfo"></p>

            <div style="margin-top:14px; display:flex; gap:10px; justify-content:center; flex-wrap:wrap;">
                <button id="shareCopy" style="border:0; cursor:pointer; padding:10px 14px; border-radius:12px; font-weight:800; background:#ffffff; color:#4c1d95;">ğŸ”— ë§í¬ ë³µì‚¬</button>
                <a href="index.html" style="text-decoration:none; padding:10px 14px; border-radius:12px; font-weight:800; background:rgba(255,255,255,0.18); color:#fff; border:1px solid rgba(255,255,255,0.35);">â†©ï¸ ë‹¤ì‹œ ë¶„ì„</a>
            </div>
            <div style="margin-top:10px; font-size:0.9rem; opacity:0.9;">ê³µìœ í•´ì„œ ì¹œêµ¬ë‘ ê°™ì´ ë³´ê¸°</div>
            
            <div class="score-display">
                <div class="score-item">
                    <div class="label">ì¢…í•© ìš´ì„¸</div>
                    <div class="value" id="totalScore">--</div>
                </div>
                <div class="score-item">
                    <div class="label">ì—°ì• ìš´</div>
                    <div class="value" id="headerLoveScore">--</div>
                </div>
                <div class="score-item">
                    <div class="label">ì§ì—…ìš´</div>
                    <div class="value" id="headerCareerScore">--</div>
                </div>
                <div class="score-item">
                    <div class="label">ì¬ë¬¼ìš´</div>
                    <div class="value" id="headerWealthScore">--</div>
                </div>
            </div>
        </div>

        <!-- ìš´ì„¸ ì¹´ë“œ -->
        <div class="cards-grid fade-in">
            <div class="card love">
                <h3>ğŸ’ ì—°ì• ìš´</h3>
                <div class="card-score" id="loveScore">--</div>
                <div class="card-trend" id="loveTrend">ë¶„ì„ì¤‘</div>
                <p class="card-desc" id="loveDesc">ë¶„ì„ì¤‘...</p>
            </div>
            
            <div class="card career">
                <h3>ğŸ’¼ ì§ì—…ìš´</h3>
                <div class="card-score" id="careerScore">--</div>
                <div class="card-trend" id="careerTrend">ë¶„ì„ì¤‘</div>
                <p class="card-desc" id="careerDesc">ë¶„ì„ì¤‘...</p>
            </div>
            
            <div class="card wealth">
                <h3>ğŸ’° ì¬ë¬¼ìš´</h3>
                <div class="card-score" id="wealthScore">--</div>
                <div class="card-trend" id="wealthTrend">ë¶„ì„ì¤‘</div>
                <p class="card-desc" id="wealthDesc">ë¶„ì„ì¤‘...</p>
            </div>
            
            <div class="card health">
                <h3>ğŸƒ ê±´ê°•ìš´</h3>
                <div class="card-score" id="healthScore">--</div>
                <div class="card-trend" id="healthTrend">ë¶„ì„ì¤‘</div>
                <p class="card-desc" id="healthDesc">ë¶„ì„ì¤‘...</p>
            </div>
        </div>

        <!-- ì‚¬ì£¼íŒ”ì -->
        <div class="analysis-section fade-in">
            <h3>ğŸ“Š ì‚¬ì£¼íŒ”ì (å››æŸ±å…«å­—)</h3>
            <div class="saju-display" id="sajuDisplay">
                <div class="pillar">
                    <div class="pillar-title">ì—°ì£¼ (å¹´æŸ±)</div>
                    <div class="pillar-chinese" id="yearPillar">--</div>
                    <div class="pillar-korean" id="yearPillarKr">--</div>
                </div>
                <div class="pillar">
                    <div class="pillar-title">ì›”ì£¼ (æœˆæŸ±)</div>
                    <div class="pillar-chinese" id="monthPillar">--</div>
                    <div class="pillar-korean" id="monthPillarKr">--</div>
                </div>
                <div class="pillar">
                    <div class="pillar-title">ì¼ì£¼ (æ—¥æŸ±)</div>
                    <div class="pillar-chinese" id="dayPillar">--</div>
                    <div class="pillar-korean" id="dayPillarKr">--</div>
                </div>
                <div class="pillar">
                    <div class="pillar-title">ì‹œì£¼ (æ™‚æŸ±)</div>
                    <div class="pillar-chinese" id="timePillar">--</div>
                    <div class="pillar-korean" id="timePillarKr">--</div>
                </div>
            </div>
            <p id="sajuSummary" style="margin-top: 20px; text-align: center; color: #4b5563;"></p>

            <div id="pillarExplain" style="margin-top:16px; padding:16px; border-radius:14px; background:#f8fafc; border:1px solid #e5e7eb;">
                <div style="font-weight:900; color:#111827;">ğŸ§¾ ë‚´ ì‚¬ì£¼ 4ê¸°ë‘¥(ì—°Â·ì›”Â·ì¼Â·ì‹œ) ê°œì¸ í•´ì„</div>
                <div id="pillarExplainText" style="margin-top:10px; color:#374151; line-height:1.7; white-space:pre-line;">ë¶„ì„ì¤‘...</div>
                <div id="pillarExplainTip" style="margin-top:12px; font-weight:800; color:#4c1d95;">âœ… ì˜¤ëŠ˜ í¬ì¸íŠ¸: ë¶„ì„ì¤‘...</div>
            </div>
        </div>

        <!-- ì˜¤í–‰ ë¶„ì„ -->
        <div class="analysis-section fade-in">
            <h3>âš–ï¸ ì˜¤í–‰ ê· í˜• ë¶„ì„</h3>
            <div class="element-bars">
                <div class="element-bar element-wood">
                    <div class="label">ëª©(æœ¨)</div>
                    <div class="bar-container">
                        <div class="bar-fill" id="woodBar" style="width: 0%"></div>
                    </div>
                    <div class="percentage" id="woodPercent">0%</div>
                </div>
                <div class="element-bar element-fire">
                    <div class="label">í™”(ç«)</div>
                    <div class="bar-container">
                        <div class="bar-fill" id="fireBar" style="width: 0%"></div>
                    </div>
                    <div class="percentage" id="firePercent">0%</div>
                </div>
                <div class="element-bar element-earth">
                    <div class="label">í† (åœŸ)</div>
                    <div class="bar-container">
                        <div class="bar-fill" id="earthBar" style="width: 0%"></div>
                    </div>
                    <div class="percentage" id="earthPercent">0%</div>
                </div>
                <div class="element-bar element-metal">
                    <div class="label">ê¸ˆ(é‡‘)</div>
                    <div class="bar-container">
                        <div class="bar-fill" id="metalBar" style="width: 0%"></div>
                    </div>
                    <div class="percentage" id="metalPercent">0%</div>
                </div>
                <div class="element-bar element-water">
                    <div class="label">ìˆ˜(æ°´)</div>
                    <div class="bar-container">
                        <div class="bar-fill" id="waterBar" style="width: 0%"></div>
                    </div>
                    <div class="percentage" id="waterPercent">0%</div>
                </div>
            </div>
            <p id="elementSummary" style="margin-top: 15px; text-align: center; color: #4b5563;"></p>

            <div id="elementDeepDive" style="margin-top:16px; padding:16px; border-radius:14px; background:#f8fafc; border:1px solid #e5e7eb;">
                <div style="font-weight:900; color:#111827;">ğŸ”¥ ë„ˆì˜ ì˜¤í–‰ ë°¸ëŸ°ìŠ¤ í•œ ë²ˆì— ì •ë¦¬</div>
                <div id="elementDeepText" style="margin-top:10px; color:#374151; line-height:1.65; white-space:pre-line;">ë¶„ì„ì¤‘...</div>
                <div id="elementActionTip" style="margin-top:12px; font-weight:800; color:#4c1d95;">âœ… ì•¡ì…˜íŒ: ë¶„ì„ì¤‘...</div>
            </div>
        </div>

        <!-- ì„±ê²© ë¶„ì„ -->
        <div class="analysis-section fade-in">
            <h3>ğŸ­ ì„±ê²© ë¶„ì„</h3>
            <div id="personalityAnalysis">
                <p>ë¶„ì„ì¤‘...</p>
            </div>
        </div>

        <!-- MBTI ì—°ë™ -->
        <div class="analysis-section fade-in" id="mbtiSection" style="display: none;">
            <h3>ğŸ§  MBTI Ã— ì‚¬ì£¼ ìœµí•© ë¶„ì„</h3>
            <div id="mbtiAnalysis">
                <p>ë¶„ì„ì¤‘...</p>
            </div>
        </div>

        <!-- ì‹­ì‹ (3ë²ˆ) -->
        <div class="analysis-section fade-in">
            <h3>ğŸ§© ë‚´ ì‚¬ì£¼ì˜ ìºë¦­í„°(ì‹­ì‹ )</h3>
            <div id="tenGodsAnalysis">
                <p>ë¶„ì„ì¤‘...</p>
            </div>
        </div>

        <!-- ìš©ì‹ /ê¸°ì‹  -->
        <div class="analysis-section fade-in">
            <h3>ğŸŒŸ ìš©ì‹  & ê¸°ì‹  ë¶„ì„</h3>
            <div id="yongsinAnalysis">
                <p>ë¶„ì„ì¤‘...</p>
            </div>
        </div>

        <!-- ìš©ì‹ /ê¸°ì‹  ì‹¤ì²œíŒ -->
        <div class="analysis-section fade-in" id="yongsinTipsSection" style="display: none;">
            <h3>ğŸ¯ ìš©ì‹  ì‹¤ì²œ ê°€ì´ë“œ</h3>
            <div class="advice-grid" id="yongsinTipsGrid">
                <div class="advice-card" id="yongsinColorCard" style="background:#f8fafc; border-left-color:#667eea;">
                    <h4 style="color:#667eea;">ğŸ¨ ì¶”ì²œ ì»¬ëŸ¬</h4>
                    <p id="yongsinColorText">ë¶„ì„ì¤‘...</p>
                </div>
                <div class="advice-card" id="yongsinTimeCard" style="background:#f8fafc; border-left-color:#22c55e;">
                    <h4 style="color:#22c55e;">â° ì¶”ì²œ ì‹œê°„ëŒ€</h4>
                    <p id="yongsinTimeText">ë¶„ì„ì¤‘...</p>
                </div>
                <div class="advice-card" id="yongsinActionCard" style="background:#f8fafc; border-left-color:#f59e0b;">
                    <h4 style="color:#f59e0b;">âœ… ì˜¤ëŠ˜ ì•¡ì…˜ 1ê°œ</h4>
                    <p id="yongsinActionText">ë¶„ì„ì¤‘...</p>
                </div>
            </div>
        </div>

        <!-- ë§ì¶¤ ì¡°ì–¸ -->
        <div class="analysis-section fade-in">
            <h3>â­ ë§ì¶¤ ì¡°ì–¸</h3>
            <div class="advice-grid">
                <div class="advice-card advice-love">
                    <h4>ğŸ’ ì—°ì•  ì¡°ì–¸</h4>
                    <p id="loveAdvice">ë¶„ì„ì¤‘...</p>
                </div>
                <div class="advice-card advice-career">
                    <h4>ğŸ’¼ ì§ì—… ì¡°ì–¸</h4>
                    <p id="careerAdvice">ë¶„ì„ì¤‘...</p>
                </div>
                <div class="advice-card advice-wealth">
                    <h4>ğŸ’° ì¬ë¬¼ ì¡°ì–¸</h4>
                    <p id="wealthAdvice">ë¶„ì„ì¤‘...</p>
                </div>
                <div class="advice-card advice-health">
                    <h4>ğŸƒ ê±´ê°• ì¡°ì–¸</h4>
                    <p id="healthAdvice">ë¶„ì„ì¤‘...</p>
                </div>
            </div>
        </div>

        <!-- ë²„íŠ¼ -->
        <div class="action-buttons">
            <a href="index.html" class="btn btn-primary">ğŸ”„ ë‹¤ì‹œ ë¶„ì„í•˜ê¸°</a>
            <button class="btn btn-secondary" onclick="shareResult()">ğŸ“± ê²°ê³¼ ê³µìœ í•˜ê¸°</button>
        </div>

        <!-- í‘¸í„° -->
        <div class="footer">
            <p>ğŸŒŸ ì´ ë¶„ì„ ê²°ê³¼ê°€ ë„ì›€ì´ ë˜ì…¨ë‚˜ìš”?</p>
            <p style="margin-top: 10px;">Â© 2024 AI ì‚¬ì£¼ Ã— MBTI. ëª¨ë“  ë¶„ì„ ê²°ê³¼ëŠ” ì°¸ê³ ìš©ì…ë‹ˆë‹¤.</p>
        </div>
    </div>

    <script>
        // í—¤ë” "ë§í¬ ë³µì‚¬" ë²„íŠ¼ ë°”ì¸ë”©
        document.addEventListener('DOMContentLoaded', function() {
            const btn = document.getElementById('shareCopy');
            if (btn) {
                btn.addEventListener('click', function() {
                    copyToClipboard(window.location.href);
                });
            }
        });

        // URL íŒŒë¼ë¯¸í„° íŒŒì‹± (í•œê¸€ ì´ë¦„ decodeURIComponent)
        function parseURLParameters() {
            const params = new URLSearchParams(window.location.search);
            const urlParams = {};
            
            for (const [key, value] of params.entries()) {
                try {
                    // nameì€ ì´ì¤‘ ì¸ì½”ë”©ë˜ì–´ ìˆì„ ìˆ˜ ìˆìŒ
                    if (key === 'name') {
                        try {
                            urlParams[key] = decodeURIComponent(decodeURIComponent(value));
                        } catch (e) {
                            urlParams[key] = decodeURIComponent(value);
                        }
                    } else {
                        urlParams[key] = decodeURIComponent(value);
                    }
                } catch (e) {
                    console.warn('URL íŒŒë¼ë¯¸í„° ë””ì½”ë”© ì‹¤íŒ¨:', key, value);
                    urlParams[key] = value;
                }
            }
            
            return urlParams;
        }

        // íŠ¸ë Œë“œ í…ìŠ¤íŠ¸ ìƒì„±
        function getTrendText(score) {
            if (score >= 85) return { text: 'â†— ë§¤ìš° ì¢‹ìŒ', class: 'trend-up' };
            if (score >= 75) return { text: 'â†— ìƒìŠ¹ì„¸', class: 'trend-up' };
            if (score >= 65) return { text: 'â†’ ì•ˆì •', class: 'trend-stable' };
            return { text: 'â†’ ë³´í†µ', class: 'trend-stable' };
        }

        // ìš´ì„¸ ì„¤ëª… ìƒì„±
        function getFortuneDescription(category, score) {
            const descriptions = {
                love: {
                    high: 'ì¢‹ì€ ë§Œë‚¨ì˜ ê¸°íšŒê°€ ë‹¤ê°€ì˜¤ê³  ìˆìŠµë‹ˆë‹¤. ìì‹ ê°ì„ ê°€ì§€ì„¸ìš”.',
                    mid: 'ê¸°ì¡´ ê´€ê³„ë¥¼ ë”ìš± ê¹Šê²Œ ë°œì „ì‹œí‚¤ëŠ”ë° ì§‘ì¤‘í•˜ì„¸ìš”.',
                    low: 'ì¸ë‚´ì‹¬ì´ í•„ìš”í•œ ì‹œê¸°ì…ë‹ˆë‹¤. ìê¸° ìì‹ ì—ê²Œ ì§‘ì¤‘í•˜ì„¸ìš”.'
                },
                career: {
                    high: 'ìƒˆë¡œìš´ ê¸°íšŒê°€ ì°¾ì•„ì˜¬ ê²ƒì…ë‹ˆë‹¤. ì ê·¹ì ìœ¼ë¡œ ë„ì „í•˜ì„¸ìš”.',
                    mid: 'í˜„ì¬ ìƒíƒœë¥¼ ìœ ì§€í•˜ë©° ê¾¸ì¤€íˆ ë°œì „í•˜ëŠ” ì‹œê¸°ì…ë‹ˆë‹¤.',
                    low: 'ì‹ ì¤‘í•œ íŒë‹¨ì´ í•„ìš”í•œ ì‹œê¸°ì…ë‹ˆë‹¤. ì¤€ë¹„ì— ì§‘ì¤‘í•˜ì„¸ìš”.'
                },
                wealth: {
                    high: 'ìˆ˜ì… ì¦ê°€ì˜ ê¸°íšŒê°€ ë³´ì…ë‹ˆë‹¤. íˆ¬ìë¥¼ ì‹ ì¤‘íˆ ê²€í† í•˜ì„¸ìš”.',
                    mid: 'ì•ˆì •ì ì¸ ì¬ì • ê´€ë¦¬ì— ì§‘ì¤‘í•˜ë©´ ì¢‹ì€ ê²°ê³¼ê°€ ìˆìŠµë‹ˆë‹¤.',
                    low: 'ì§€ì¶œ ê´€ë¦¬ì— íŠ¹íˆ ì‹ ê²½ì“°ê³ , ì €ì¶•ì— ì§‘ì¤‘í•˜ì„¸ìš”.'
                },
                health: {
                    high: 'ì „ë°˜ì ìœ¼ë¡œ ì–‘í˜¸í•©ë‹ˆë‹¤. í™œë°œí•œ í™œë™ì„ ê¶Œì¥í•©ë‹ˆë‹¤.',
                    mid: 'ê·œì¹™ì ì¸ ê´€ë¦¬ê°€ í•„ìš”í•©ë‹ˆë‹¤. ê±´ê°• ìŠµê´€ì„ ìœ ì§€í•˜ì„¸ìš”.',
                    low: 'ì¶©ë¶„í•œ íœ´ì‹ê³¼ ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬ì— ì‹ ê²½ì“°ì„¸ìš”.'
                }
            };

            if (score >= 80) return descriptions[category].high;
            if (score >= 65) return descriptions[category].mid;
            return descriptions[category].low;
        }

        // ë©”ì¸ ë¶„ì„ ì‹¤í–‰
        document.addEventListener('DOMContentLoaded', function() {
            const params = parseURLParameters();
            
            // í•„ìˆ˜ íŒŒë¼ë¯¸í„° ì²´í¬
            if (!params.name || !params.year || !params.month || !params.day || !params.gender) {
                alert('í•„ìˆ˜ ì •ë³´ê°€ ëˆ„ë½ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                window.location.href = 'index.html';
                return;
            }

            // ë°ì´í„° íŒŒì‹±
            const userData = {
                name: params.name,
                year: parseInt(params.year),
                month: parseInt(params.month),
                day: parseInt(params.day),
                hour: params.hour === '-1' ? 12 : parseInt(params.hour), // ëª¨ë¦„ì´ë©´ ê¸°ë³¸ê°’ 12ì‹œ
                gender: params.gender,
                mbti: params.mbti || null
            };

            console.log('ì‚¬ìš©ì ë°ì´í„°:', userData);

            // ë¶„ì„ ì‹¤í–‰ (ì•½ê°„ì˜ ì§€ì—°ìœ¼ë¡œ ë¡œë”© íš¨ê³¼)
            setTimeout(function() {
                runAnalysis(userData);
            }, 1000);

            // ë¬´í•œë¡œë”© ë°©ì§€: 5ì´ˆ í›„ì—ë„ ë¡œë”© ì¤‘ì´ë©´ ê°•ì œ í‘œì‹œ
            setTimeout(function() {
                var overlay = document.getElementById('loadingOverlay');
                var content = document.getElementById('mainContent');
                if (overlay && overlay.style.display !== 'none') {
                    console.warn('ë¶„ì„ íƒ€ì„ì•„ì›ƒ - í´ë°± ê²°ê³¼ í‘œì‹œ');
                    overlay.style.display = 'none';
                    if (content) content.style.display = 'block';
                }
            }, 5000);
        });

        function runAnalysis(userData) {
            try {
                // ì‚¬ì£¼ ê³„ì‚°
                let sajuData = null;
                if (typeof calculateSaju === 'function') {
                    sajuData = calculateSaju(userData.year, userData.month, userData.day, userData.hour, userData.gender);
                    console.log('ì‚¬ì£¼ ë°ì´í„°:', sajuData);
                }

                // ê°œì¸ ë¶„ì„ ìƒì„±
                let analysisData = null;
                if (typeof generatePersonalAnalysis === 'function' && sajuData) {
                    const birthInfo = {
                        name: userData.name,
                        year: userData.year,
                        month: userData.month,
                        day: userData.day,
                        hour: userData.hour,
                        gender: userData.gender
                    };
                    analysisData = generatePersonalAnalysis(sajuData, userData.mbti || 'ENFP', birthInfo);
                    console.log('ë¶„ì„ ë°ì´í„°:', analysisData);
                }

                // ê²°ê³¼ í‘œì‹œ
                displayResults(userData, sajuData, analysisData);

            } catch (error) {
                console.error('ë¶„ì„ ì˜¤ë¥˜:', error);
                displayFallbackResults(userData);
            }

            // ë¡œë”© ìˆ¨ê¸°ê³  ì½˜í…ì¸  í‘œì‹œ
            document.getElementById('loadingOverlay').style.display = 'none';
            document.getElementById('mainContent').style.display = 'block';
        }

        // ì•ˆì „í•œ DOM ì—…ë°ì´íŠ¸ í—¬í¼
        function safeSetText(id, text) {
            var el = document.getElementById(id);
            if (el && text != null) el.textContent = text;
        }
        function safeSetHTML(id, html) {
            var el = document.getElementById(id);
            if (el && html != null) el.innerHTML = html;
        }
        function safeSetStyle(id, prop, val) {
            var el = document.getElementById(id);
            if (el && val != null) el.style[prop] = val;
        }

        function displayResults(userData, sajuData, analysisData) {
            // í—¤ë” ì •ë³´
            safeSetText('reportTitle', (userData.name || '') + 'ë‹˜ì˜ ì‚¬ì£¼ ë¶„ì„ ê²°ê³¼');
            safeSetText('userInfo',
                (userData.gender === 'M' ? 'ë‚¨ì„±' : 'ì—¬ì„±') + ' Â· ' +
                userData.year + 'ë…„ ' + userData.month + 'ì›” ' + userData.day + 'ì¼ìƒ' +
                (userData.mbti ? ' Â· ' + userData.mbti : ''));

            // ì ìˆ˜ ê³„ì‚° (ë¶„ì„ ë°ì´í„°ê°€ ìˆìœ¼ë©´ ì‚¬ìš©, ì—†ìœ¼ë©´ ê¸°ë³¸ê°’)
            var scores = (analysisData && analysisData.fortuneScores) ? analysisData.fortuneScores : {
                overall: 80,
                love: 78,
                career: 82,
                health: 75,
                wealth: 77
            };

            // í—¤ë” ì ìˆ˜
            safeSetText('totalScore', scores.overall);
            safeSetText('headerLoveScore', scores.love);
            safeSetText('headerCareerScore', scores.career);
            safeSetText('headerWealthScore', scores.wealth);

            // ì¹´ë“œ ì ìˆ˜ ë° ì„¤ëª…
            var categories = ['love', 'career', 'wealth', 'health'];
            categories.forEach(function(cat) {
                var score = scores[cat] || 75;
                var trend = getTrendText(score);
                
                safeSetText(cat + 'Score', score);
                safeSetText(cat + 'Trend', trend.text);
                var trendEl = document.getElementById(cat + 'Trend');
                if (trendEl) trendEl.className = 'card-trend ' + trend.class;
                safeSetText(cat + 'Desc', getFortuneDescription(cat, score));
            });

            // ì‚¬ì£¼íŒ”ì í‘œì‹œ
            if (sajuData && sajuData.pillars) {
                var pillars = sajuData.pillars;
                
                if (pillars.year) {
                    safeSetText('yearPillar', pillars.year.chinese || '--');
                    safeSetText('yearPillarKr', (pillars.year.stemName || '') + (pillars.year.branchName || ''));
                }
                if (pillars.month) {
                    safeSetText('monthPillar', pillars.month.chinese || '--');
                    safeSetText('monthPillarKr', (pillars.month.stemName || '') + (pillars.month.branchName || ''));
                }
                if (pillars.day) {
                    safeSetText('dayPillar', pillars.day.chinese || '--');
                    safeSetText('dayPillarKr', (pillars.day.stemName || '') + (pillars.day.branchName || ''));
                }
                if (pillars.time) {
                    safeSetText('timePillar', pillars.time.chinese || '--');
                    safeSetText('timePillarKr', (pillars.time.stemName || '') + (pillars.time.branchName || ''));
                }

                if (pillars.day && pillars.year) {
                    safeSetText('sajuSummary',
                        'ì‚¬ì£¼íŒ”ì(å››æŸ±å…«å­—)ëŠ” íƒœì–´ë‚œ ì‹œì ì˜ â€œì—°(å¹´)Â·ì›”(æœˆ)Â·ì¼(æ—¥)Â·ì‹œ(æ™‚)â€ ë„¤ ê¸°ë‘¥(å››æŸ±)ì„ ë³´ê³ , ' +
                        'ê° ê¸°ë‘¥ì„ ì´ë£¨ëŠ” ì²œê°„/ì§€ì§€ì˜ 8ê¸€ì(å…«å­—)ë¡œ ê¸°ìš´ì˜ íë¦„ì„ í•´ì„í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤. ' +
                        'ë‹¹ì‹ ì˜ í•µì‹¬ì€ ì¼ê°„(ë‚˜ ìì‹ )ì¸ ' + (pillars.day.stemName || '') + '(' + (pillars.day.element || '') + ')ì´ê³ , ' +
                        (pillars.year.animal || '') + 'í•´ì˜ í™˜ê²½ ì†ì—ì„œ íƒœì–´ë‚¬ìŠµë‹ˆë‹¤. ' +
                        'ì—°ì£¼ëŠ” â€œë°”ê¹¥ ì´ë¯¸ì§€/ì´ˆë°˜ í™˜ê²½â€, ì›”ì£¼ëŠ” â€œì‚¬íšŒì  ì—­í• Â·ì¼/ì»¤ë¦¬ì–´â€, ì¼ì£¼ëŠ” â€œë‚´ ì„±í–¥ì˜ ì¤‘ì‹¬(ê¸°ë³¸ê°’)â€, ì‹œì£¼ëŠ” â€œë¯¸ë˜ì˜ ë°©í–¥Â·ì ì¬ë ¥/ë§ë…„â€ì„ ë´…ë‹ˆë‹¤. ' +
                        'í•œ ì¤„ë¡œ ìš”ì•½í•˜ë©´: ì‚¬ì£¼ëŠ” ìš´ëª…ì„ ê³ ì •í•˜ëŠ” ê²Œ ì•„ë‹ˆë¼, â€œë‚´ê°€ ì–´ë–¤ ë¦¬ë“¬ì—ì„œ ê°•í•´ì§€ê³  ì–´ë–¤ ìƒí™©ì—ì„œ í”ë“¤ë¦¬ëŠ”ì§€â€ë¥¼ ì§€ë„ì²˜ëŸ¼ ë³´ì—¬ì£¼ëŠ” ë„êµ¬ì˜ˆìš”.');

                    // 1) 4ê¸°ë‘¥ ê°œì¸ í•´ì„(ì§§ê³  ì‹¤ìš©ì ìœ¼ë¡œ)
                    var y = pillars.year || {};
                    var m = pillars.month || {};
                    var d = pillars.day || {};
                    var t = pillars.time || {};

                    var yearExplain = `ì—°ì£¼(å¹´æŸ±): â€˜ë°”ê¹¥ í”„ë ˆì„â€™(ì´ˆë°˜ í™˜ê²½/ê°€ë¬¸/ì²«ì¸ìƒ).\n- ${y.chinese || ''} (${(y.stemName||'') + (y.branchName||'')})\n- í¬ì¸íŠ¸: ì—°ì£¼ëŠ” ë‚˜ë¥¼ ë‘˜ëŸ¬ì‹¼ â€œê¸°ë³¸ ë°°ê²½â€ì´ë¼, ê°™ì€ ì„±ê²©ì´ë¼ë„ ëŒ€ì™¸ ì´ë¯¸ì§€ê°€ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆì–´.`;
                    var monthExplain = `ì›”ì£¼(æœˆæŸ±): â€˜ì‚¬íšŒ ì¶•â€™(ì›”ë ¹=ê³„ì ˆ ê¸°ìš´ / ì»¤ë¦¬ì–´Â·ë£¨í‹´).\n- ${m.chinese || ''} (${(m.stemName||'') + (m.branchName||'')})\n- í¬ì¸íŠ¸: ì‚¬ì£¼ì—ì„œ ì›”ì£¼ëŠ” ê³„ì ˆ(ì›”ë ¹)ì˜ ì˜í–¥ì´ ì»¤ì„œ, ì¼/ì‚¬íšŒì—ì„œ ìì£¼ ì“°ëŠ” íŒ¨í„´ì´ ì—¬ê¸°ì„œ ê°•í•˜ê²Œ ë“œëŸ¬ë‚¨.`;
                    var dayExplain = `ì¼ì£¼(æ—¥æŸ±): â€˜ë‚˜ì˜ ê¸°ë³¸ê°’â€™(ì¼ê°„=ë‚˜ ìì‹  / ê´€ê³„ì˜ ê²°).\n- ${d.chinese || ''} (${(d.stemName||'') + (d.branchName||'')})\n- í¬ì¸íŠ¸: ì¼ê°„(ì²œê°„)ì´ â€œë‚´ê°€ ì›ë˜ ì“°ëŠ” ì—”ì§„â€ì´ë¼, í˜ë“¤ ë•Œë„ ê²°êµ­ ì—¬ê¸°ë¡œ ëŒì•„ì˜¤ëŠ” ê²½í–¥ì´ ìˆì–´.`;
                    var timeExplain = `ì‹œì£¼(æ™‚æŸ±): â€˜ë¯¸ë˜/ê²°ì‹¤â€™(ì ì¬ë ¥Â·í›„ë°˜ìš´ / ìì‹Â·ì„±ê³¼).\n- ${t.chinese || ''} (${(t.stemName||'') + (t.branchName||'')})\n- í¬ì¸íŠ¸: ì‹œì£¼ëŠ” ì‹œê°„ì´ ê°ˆìˆ˜ë¡ ì²´ê°ì´ ì»¤ì§€ëŠ” ì˜ì—­ì´ë¼, 20~30ëŒ€ë³´ë‹¤ 30~40ëŒ€ ì´í›„ì— ê°•ì ì´ ëšœë ·í•´ì§€ê¸°ë„ í•´.`;

                    var explainText = [yearExplain, monthExplain, dayExplain, timeExplain].join('\n\n');
                    safeSetText('pillarExplainText', explainText);

                    // ì˜¤ëŠ˜ í¬ì¸íŠ¸: ì¼ì£¼(ì¼ê°„) + ì›”ì£¼(ì»¤ë¦¬ì–´) ê¸°ì¤€ìœ¼ë¡œ í•œ ì¤„ íŒ
                    var dayStem = (d.stemName || '');
                    var monthStem = (m.stemName || '');
                    safeSetText('pillarExplainTip', `âœ… ì˜¤ëŠ˜ í¬ì¸íŠ¸: ì¼ì£¼(ë‚˜)ì˜ ${dayStem} ê¸°ìš´ì„ â€œí•µì‹¬ 1ê°œâ€ì— ì“°ê³ , ì›”ì£¼(ì¼/ì‚¬íšŒ)ì˜ ${monthStem} ê¸°ìš´ì€ â€œì •ë¦¬/ìš°ì„ ìˆœìœ„â€ì— ì¨ë´.`);
                }
            }

            // ì˜¤í–‰ ë¶„ì„ í‘œì‹œ
            if (sajuData && sajuData.fiveElements && sajuData.fiveElements.percentages) {
                var elements = sajuData.fiveElements.percentages;
                
                safeSetStyle('woodBar', 'width', (elements['ëª©'] || 0) + '%');
                safeSetText('woodPercent', (elements['ëª©'] || 0) + '%');
                
                safeSetStyle('fireBar', 'width', (elements['í™”'] || 0) + '%');
                safeSetText('firePercent', (elements['í™”'] || 0) + '%');
                
                safeSetStyle('earthBar', 'width', (elements['í† '] || 0) + '%');
                safeSetText('earthPercent', (elements['í† '] || 0) + '%');
                
                safeSetStyle('metalBar', 'width', (elements['ê¸ˆ'] || 0) + '%');
                safeSetText('metalPercent', (elements['ê¸ˆ'] || 0) + '%');
                
                safeSetStyle('waterBar', 'width', (elements['ìˆ˜'] || 0) + '%');
                safeSetText('waterPercent', (elements['ìˆ˜'] || 0) + '%');

                safeSetText('elementSummary',
                    (sajuData.fiveElements.strongest || 'í† ') + ' ê¸°ìš´ì´ ê°•í•˜ê³ , ' +
                    (sajuData.fiveElements.weakest || 'ìˆ˜') + ' ê¸°ìš´ì´ ì•½í•©ë‹ˆë‹¤.');

                // 2) ì˜¤í–‰ ë°¸ëŸ°ìŠ¤ í™•ì¥(ì‰¬ìš´ ì„¤ëª… + ë£¨í‹´)
                const strong = sajuData.fiveElements.strongest;
                const weak = sajuData.fiveElements.weakest;
                const map = {
                    'ëª©': { title: 'ëª©(æœ¨) ê¸°ìš´', good: 'ì•„ì´ë””ì–´/ì„±ì¥/ê´€ê³„ í™•ì¥ì— ê°•í•´. ì‹œì‘ì´ ë¹ ë¥´ê³ , ì‚¬ëŒÂ·ê¸°íšŒê°€ ì˜ ë¶™ëŠ” íƒ€ì….', tooMuch: 'ê·¼ë° ìš•ì‹¬ì´ ì»¤ì§€ë©´ ì‚°ë§Œí•´ì§€ê³  â€œí•˜ë‹¤ ë§Œ ì¼â€ì´ ëŠ˜ ìˆ˜ ìˆì–´.', add: 'ë¬¼ê±´/ì¼ì •ì€ â€œì‹œì‘â€ë³´ë‹¤ â€œë§ˆê°â€ì„ ë¨¼ì € ì¡ì•„ì£¼ëŠ” ê²Œ ë°¸ëŸ°ìŠ¤ì— ë„ì›€.', routine: 'ë§¤ì£¼ 1ê°œë§Œ â€œëë‚´ê¸° í”„ë¡œì íŠ¸â€ë¡œ ê³ ì •í•´ë´.' },
                    'í™”': { title: 'í™”(ç«) ê¸°ìš´', good: 'í‘œí˜„/ì—ë„ˆì§€/ìŠ¹ë¶€ìš•ì´ ê°•í•´. ë¶„ìœ„ê¸° ë©”ì´ì»¤ + ì¶”ì§„ë ¥ìœ¼ë¡œ íŒì„ í‚¤ìš°ëŠ” íƒ€ì….', tooMuch: 'ê³¼í•˜ë©´ ê°ì •ê¸°ë³µ/ë²ˆì•„ì›ƒì´ ì˜¤ê¸° ì‰½ê³ , ë§ì´ ì•ì„œì„œ ì˜¤í•´ê°€ ìƒê¸¸ ìˆ˜ ìˆì–´.', add: 'ì—ë„ˆì§€ë¥¼ â€œì§§ê³  êµµê²Œâ€ ì“°ê³  íšŒë³µ ë£¨í‹´ì„ ì˜ì‹ì ìœ¼ë¡œ ë„£ì–´ì•¼ í•¨.', routine: 'ì  30ë¶„ ë” + ì¹´í˜ì¸ ì»·ì˜¤í”„(ì˜¤í›„ 2ì‹œ)ë§Œ í•´ë„ ì²´ê° ë‹¬ë¼ì§.' },
                    'í† ': { title: 'í† (åœŸ) ê¸°ìš´', good: 'ì•ˆì •/ì¡°ìœ¨/ì±…ì„ê°ì´ ê°•í•´. íŒ€ì—ì„œ ì¤‘ì‹¬ ì¡ê³  ëê¹Œì§€ ê°€ì ¸ê°€ëŠ” íƒ€ì….', tooMuch: 'ê³¼í•˜ë©´ ìƒê°ì´ ë¬´ê±°ì›Œì§€ê³ , ê²°ì •ì´ ëŠë ¤ì§ˆ ìˆ˜ ìˆì–´(â€œì¼ë‹¨ ë³´ë¥˜â€).', add: 'ì„ íƒì§€ë¥¼ ì¤„ì´ê³  â€œê¸°ì¤€ 1ê°œâ€ë¡œ ë¹¨ë¦¬ ê²°ì •í•˜ëŠ” ì—°ìŠµì´ ì¢‹ìŒ.', routine: 'ê²°ì •í•´ì•¼ í•  ì¼ì€ 10ë¶„ íƒ€ì´ë¨¸ ê±¸ê³  ê²°ë¡  ë‚´ë¦¬ê¸°.' },
                    'ê¸ˆ': { title: 'ê¸ˆ(é‡‘) ê¸°ìš´', good: 'íŒë‹¨/ì •ë¦¬/ê¸°ì¤€ì´ ëšœë ·í•´. ë””í…Œì¼Â·í€„ë¦¬í‹°Â·íš¨ìœ¨ì„ ì±™ê¸°ëŠ” íƒ€ì….', tooMuch: 'ê³¼í•˜ë©´ ë‚ ì¹´ë¡œì›Œ ë³´ì´ê±°ë‚˜ ì™„ë²½ì£¼ì˜ë¡œ ìŠ¤íŠ¸ë ˆìŠ¤ê°€ ì»¤ì§ˆ ìˆ˜ ìˆì–´.', add: 'ì™„ë²½ë³´ë‹¤ â€œì¶œì‹œâ†’ê°œì„ â€ ë£¨í”„ë¡œ ê°€ë©´ ì˜¤íˆë ¤ ì„±ê³¼ê°€ ë¹¨ë¼ì§.', routine: 'To-doì— â€œì´ˆì•ˆ(60%)â€ ë‹¨ê³„ë¥¼ ë”°ë¡œ ë„£ì–´ë´.' },
                    'ìˆ˜': { title: 'ìˆ˜(æ°´) ê¸°ìš´', good: 'ê´€ì°°/ì •ë³´/ê¹Šì´ê°€ ê°•í•´. íë¦„ì„ ì½ê³  ê³µë¶€/ë¶„ì„ìœ¼ë¡œ ì—­ì „í•˜ëŠ” íƒ€ì….', tooMuch: 'ê³¼í•˜ë©´ ìƒê°ì´ ë§ì•„ì ¸ì„œ í–‰ë™ì´ ëŠ¦ì–´ì§ˆ ìˆ˜ ìˆì–´(â€œê³„ì† ì¡°ì‚¬â€).', add: 'ì‘ì€ ì‹¤í–‰ì„ ë¨¼ì € í•˜ê³  ë°ì´í„°ë¡œ ë³´ì™„í•˜ëŠ” ê²Œ ë°¸ëŸ°ìŠ¤ì— ë„ì›€.', routine: 'ì˜¤ëŠ˜ í•  ì¼ 1ê°œëŠ” â€œì¡°ì‚¬ ì—†ì´ ë°”ë¡œ ì‹¤í–‰â€ ë£°ë¡œ í•´ë´.' }
                };
                const s = map[strong] || map['í† '];
                const w = map[weak] || map['ìˆ˜'];

                const deep = [
                    `ê°•í•œ ê¸°ìš´: ${strong} â†’ ${s.good}`,
                    `ì£¼ì˜(ê³¼í•˜ë©´): ${s.tooMuch}`,
                    `ì•½í•œ ê¸°ìš´: ${weak} â†’ ${w.title}ì´ ì•½í•œ í¸ì´ë¼, ${w.add}`
                ].join('\n\n');

                const action = `âœ… ì•¡ì…˜íŒ: ${w.routine}`;

                const deepEl = document.getElementById('elementDeepText');
                const actionEl = document.getElementById('elementActionTip');
                if (deepEl) deepEl.textContent = deep;
                if (actionEl) actionEl.textContent = action;
            }

            // ì„±ê²© ë¶„ì„ (í™•ì¥)
            if (analysisData && analysisData.personality) {
                var personality = analysisData.personality;
                var detail = (personality.detailedAnalysis || '').trim();
                var detailLines = detail ? detail.split('\n').filter(Boolean) : [];
                var line1 = detailLines[0] || '';
                var line2 = detailLines[1] || '';

                // ì˜¤í–‰ strongest/weakest ê¸°ë°˜ìœ¼ë¡œ 'ê°•ì /ì£¼ì˜/ê´€ê³„/ì‹¤ì²œ'ì„ ì¶”ê°€ë¡œ ë§Œë“¤ì–´ì¤Œ
                var strongest = (sajuData && sajuData.fiveElements) ? sajuData.fiveElements.strongest : null;
                var weakest = (sajuData && sajuData.fiveElements) ? sajuData.fiveElements.weakest : null;

                var map = {
                    'ëª©': { strength: 'ì„±ì¥ ìš•êµ¬, ì¶”ì§„ë ¥, ìƒˆë¡œìš´ ì‹œë„ì— ê°•í•¨', caution: 'ê¸‰í•˜ê²Œ ê²°ë¡  ë‚´ë¦¬ê±°ë‚˜ ë§ì´ ì•ì„¤ ìˆ˜ ìˆìŒ', relation: 'ìƒëŒ€ì˜ ê°€ëŠ¥ì„±ì„ í‚¤ì›Œì£¼ëŠ” íƒ€ì…. ë‹¤ë§Œ ì”ì†Œë¦¬ì²˜ëŸ¼ ë“¤ë¦¬ì§€ ì•Šê²Œ í†¤ ì¡°ì ˆ', action: 'ì˜¤ëŠ˜ â€œìƒˆë¡œìš´ ê²ƒ 1ê°œâ€ë¥¼ 10ë¶„ë§Œ ë§›ë³´ê¸°(ì½ê¸°/ê²€ìƒ‰/ì‹œì‘)' },
                    'í™”': { strength: 'í‘œí˜„ë ¥, ì—´ì •, ë¶„ìœ„ê¸° ë©”ì´ì»¤ ê¸°ì§ˆ', caution: 'ê³¼ì—´ë˜ë©´ ë²ˆì•„ì›ƒ/ê°ì •ê¸°ë³µ', relation: 'ê°ì • í‘œí˜„ì´ ë¶„ëª…í•´ì„œ ê´€ê³„ê°€ ë¹¨ë¦¬ ê°€ê¹Œì›Œì§. ë‹¤ë§Œ ìƒëŒ€ì—ê²Œ ìˆ¨ ì‰´ í‹ˆ ì£¼ê¸°', action: 'ì˜¤ëŠ˜ ì—ë„ˆì§€ í”¼í¬(ì˜¤ì „~ì ì‹¬)ì— í•µì‹¬ 1ê±´ ì²˜ë¦¬' },
                    'í† ': { strength: 'ì•ˆì •ê°, í˜„ì‹¤ ê°ê°, ë²„íŒ€ëª© ì—­í• ', caution: 'ê³ ì§‘/ë£¨í‹´ì— ê°‡í˜€ ë³€í™”ê°€ ëŠ¦ì–´ì§ˆ ìˆ˜ ìˆìŒ', relation: 'ì‹ ë¢°ë¥¼ ìŒ“ëŠ” ë° ê°•í•¨. ëŒ€ì‹  ê°ì • í‘œí˜„ì€ ì˜ì‹ì ìœ¼ë¡œ ëŠ˜ë¦¬ë©´ ì¢‹ìŒ', action: 'ì˜¤ëŠ˜ ê³µê°„/íŒŒì¼/ì¼ì • â€œì •ë¦¬ 10ë¶„â€ìœ¼ë¡œ ì¤‘ì‹¬ ì¡ê¸°' },
                    'ê¸ˆ': { strength: 'íŒë‹¨ë ¥, ê¸°ì¤€, ë””í…Œì¼/ì™„ì„±ë„', caution: 'ì™„ë²½ì£¼ì˜/ë¹„íŒì  ì‚¬ê³ ê°€ ê°•í•´ì§ˆ ìˆ˜ ìˆìŒ', relation: 'ê´€ê³„ì—ì„œë„ ê¸°ì¤€ì´ ëšœë ·. ì¹­ì°¬ì„ ë§ë¡œ ë¨¼ì € êº¼ë‚´ë©´ ê· í˜•ì´ ì¢‹ì•„ì§', action: 'ì˜¤ëŠ˜ ë¯¸ë¤„ë‘” 1ê°œë¥¼ â€œëë‚´ê¸°â€ë¡œ ë§ˆê°' },
                    'ìˆ˜': { strength: 'ê´€ì°°ë ¥, ëª°ì…, ê¹Šì´ ìˆëŠ” ì‚¬ê³ ', caution: 'ìƒê°ì´ ë§ì•„ ì‹¤í–‰ì´ ëŠ¦ì–´ì§€ê±°ë‚˜ ìš°ìš¸ê°', relation: 'ê¹Šê²Œ ì—°ê²°ë˜ë©´ ì˜¤ë˜ê°. ë‹¤ë§Œ í˜¼ìë§Œì˜ ì‹œê°„ì´ í•„ìš”í•˜ë‹¨ ê±¸ ë¯¸ë¦¬ ê³µìœ ', action: 'ì˜¤ëŠ˜ ë°¤ 20ë¶„ â€˜í˜¼ì ëª°ì…â€™(ë…ì„œ/ê³µë¶€/ì •ë¦¬) í™•ë³´' }
                };

                var base = map[strongest] || { strength: 'ìƒí™© íŒë‹¨ê³¼ ê· í˜• ê°ê°', caution: 'ê³¼í•˜ë©´ í•œìª½ìœ¼ë¡œ ì¹˜ìš°ì¹¨', relation: 'ìƒëŒ€ì™€ ì†ë„ë¥¼ ë§ì¶”ë©´ ì¥ì ì´ ì‚´ì•„ë‚¨', action: 'ì˜¤ëŠ˜ í•œ ê°€ì§€ë¥¼ â€œì‘ê²Œâ€ ì‹¤í–‰' };
                var weakHint = weakest ? ('\n\në³´ì™„ í¬ì¸íŠ¸: ' + weakest + ' ê¸°ìš´ì„ ì˜ì‹ì ìœ¼ë¡œ ì±„ìš°ë©´ ìš´ì˜ í”ë“¤ë¦¼ì´ ì¤„ì–´ë“­ë‹ˆë‹¤.') : '';

                safeSetHTML('personalityAnalysis',
                    '<p style="font-size:1.05rem; line-height:1.7;">' +
                        '<strong>' + (personality.corePersonality || 'ë‹¹ì‹ ì˜ ì„±í–¥') + '</strong>' +
                    '</p>' +
                    (line1 ? ('<p style="margin-top: 10px; color:#374151; line-height:1.7;">' + line1 + '</p>') : '') +
                    (line2 ? ('<p style="margin-top: 8px; color:#374151; line-height:1.7;">' + line2 + '</p>') : '') +
                    '<div style="margin-top:14px; padding:14px; border-radius:14px; background:#f8fafc; border:1px solid #e5e7eb;">' +
                        '<div style="font-weight:900; color:#111827;">ğŸ§  ì„±ê²© ë””í…Œì¼</div>' +
                        '<p style="margin-top:10px; color:#374151; line-height:1.7;"><strong>ê°•ì :</strong> ' + base.strength + '</p>' +
                        '<p style="margin-top:8px; color:#374151; line-height:1.7;"><strong>ì£¼ì˜:</strong> ' + base.caution + '</p>' +
                        '<p style="margin-top:8px; color:#374151; line-height:1.7;"><strong>ê´€ê³„/ì†Œí†µ:</strong> ' + base.relation + '</p>' +
                        '<p style="margin-top:10px; font-weight:800; color:#4c1d95;">âœ… ì˜¤ëŠ˜ ì‹¤ì²œ: ' + base.action + '</p>' +
                        (weakHint ? ('<p style="margin-top:10px; color:#6b7280; white-space:pre-line;">' + weakHint + '</p>') : '') +
                    '</div>');
            }

            // MBTI ì—°ë™ ë¶„ì„ (í™•ì¥ë²„ì „)
            if (userData.mbti && analysisData && analysisData.mbtiSajuFusion) {
                const mbtiSection = document.getElementById('mbtiSection');
                const mbtiAnalysis = document.getElementById('mbtiAnalysis');
                if (mbtiSection) mbtiSection.style.display = 'block';

                const mbti = analysisData.mbtiSajuFusion;
                const mbtiType = userData.mbti || 'ENFP';

                // MBTIë³„ í™•ì¥ ë°ì´í„°
                const mbtiExtended = {
                    'INTJ': { summary: 'ì „ëµê°€ + í†µì°°í˜•', strength: 'ì¥ê¸° í”Œëœ/ë¶„ì„/ë…ë¦½ì  ì‹¤í–‰', weakness: 'ê°ì • í‘œí˜„/ìœ ì—°ì„± ë¶€ì¡±', love: 'ê¹Šì´ ìˆëŠ” ì§€ì  êµë¥˜ ì„ í˜¸. ë°€ë‹¹ë³´ë‹¤ ì§„ì†”í•œ ëŒ€í™”ê°€ ëŒë¦¼.', career: 'ì—°êµ¬/ì „ëµ/ê¸°íš ìª½ ê°•ì . í˜¼ì ëª°ì…í•  ìˆ˜ ìˆëŠ” í™˜ê²½ì´ ìµœì .', action: 'ì˜¤ëŠ˜ ê°ì • 1ê°œë¥¼ ë§ë¡œ í‘œí˜„í•´ë³´ê¸° (ì—°ìŠµ!)' },
                    'INTP': { summary: 'ë…¼ë¦¬ìˆ ì‚¬ + ë¶„ì„í˜•', strength: 'ë…¼ë¦¬/ë¬¸ì œí•´ê²°/ì°½ì˜ì  ì•„ì´ë””ì–´', weakness: 'ì‹¤í–‰ë ¥/ê°ì • ê³µê°', love: 'ì§€ì  í˜¸ê¸°ì‹¬ ìê·¹í•˜ëŠ” ìƒëŒ€ì—ê²Œ ëŒë¦¼. ë¨¼ì € ë‹¤ê°€ê°€ê¸° ì–´ë ¤ì›€.', career: 'ê°œë°œ/ë¶„ì„/ì—°êµ¬ ì í•©. ììœ ë¡œìš´ í™˜ê²½ì—ì„œ ì—­ëŸ‰ í­ë°œ.', action: 'ì˜¤ëŠ˜ ì•„ì´ë””ì–´ 1ê°œë¥¼ "ì‘ê²Œë¼ë„ ì‹¤í–‰"í•´ë³´ê¸°' },
                    'ENTJ': { summary: 'í†µì†”ì + ë¦¬ë”í˜•', strength: 'ê²°ë‹¨/ì¶”ì§„/ì¡°ì§ ì¥ì•…ë ¥', weakness: 'ë…ì„ /ê³¼ë„í•œ í†µì œ', love: 'ëŒ€ë“±í•œ íŒŒíŠ¸ë„ˆì‹­ ì„ í˜¸. ì¡´ê²½í•  ìˆ˜ ìˆëŠ” ì‚¬ëŒì—ê²Œ ëŒë¦¼.', career: 'ê²½ì˜/ë¦¬ë”ì‹­/ì‚¬ì—… ì í•©. í° ê·¸ë¦¼ ê·¸ë¦¬ê³  ë°€ì–´ë¶™ì´ëŠ” í˜.', action: 'ì˜¤ëŠ˜ ëˆ„êµ°ê°€ ì˜ê²¬ 1ê°œ "ëê¹Œì§€ ë“¤ì–´ë³´ê¸°"' },
                    'ENTP': { summary: 'ë³€ë¡ ê°€ + ì•„ì´ë””ì–´í˜•', strength: 'í† ë¡ /ì°½ì˜/ìƒˆë¡œìš´ ì‹œë„', weakness: 'ì§€ì†ë ¥/ê°ì • ë°°ë ¤', love: 'ì¬ë¯¸ìˆê³  ìê·¹ì ì¸ ê´€ê³„ ì„ í˜¸. ë£¨í‹´ ì—°ì• ëŠ” ì§ˆë¦¼.', career: 'ê¸°íš/ë§ˆì¼€íŒ…/ìŠ¤íƒ€íŠ¸ì—… ì í•©. íŒ ë°”ê¾¸ëŠ” ì—­í• ì— ê°•ì .', action: 'ì˜¤ëŠ˜ í•˜ë˜ ì¼ 1ê°œ "ë§ˆë¬´ë¦¬"ê¹Œì§€ í•´ë³´ê¸°' },
                    'INFJ': { summary: 'ì˜¹í˜¸ì + ì´ìƒí˜•', strength: 'í†µì°°/ê³µê°/ë¹„ì „ ì œì‹œ', weakness: 'í˜„ì‹¤ íƒ€í˜‘/ìê¸° í¬ìƒ', love: 'ì˜í˜¼ì˜ êµê° ì¶”êµ¬. í‘œë©´ì  ê´€ê³„ëŠ” ê³µí—ˆí•¨.', career: 'ìƒë‹´/êµìœ¡/ì°½ì‘ ì í•©. ì˜ë¯¸ ìˆëŠ” ì¼ì— ëª°ì….', action: 'ì˜¤ëŠ˜ "ë‚´ ê¸°ì¤€"ìœ¼ë¡œ NO í•œ ë²ˆ í•´ë³´ê¸°' },
                    'INFP': { summary: 'ì¤‘ì¬ì + ì´ìƒì£¼ì˜í˜•', strength: 'ì°½ì˜/ê³µê°/ì§„ì •ì„±', weakness: 'ê²°ì •ì¥ì• /í˜„ì‹¤ íšŒí”¼', love: 'ì´ìƒì  ì‚¬ë‘ ì¶”êµ¬. ìƒëŒ€ë°© ë‚´ë©´ì— ëŒë¦¼.', career: 'ì°½ì‘/ìƒë‹´/ì˜ˆìˆ  ì í•©. ê°€ì¹˜ ì¼ì¹˜ê°€ ë™ê¸°ë¶€ì—¬.', action: 'ì˜¤ëŠ˜ ê²°ì • 1ê°œ "5ë¶„ ì•ˆì—" ë‚´ë ¤ë³´ê¸°' },
                    'ENFJ': { summary: 'ì„ ë„ì + ì¹´ë¦¬ìŠ¤ë§ˆí˜•', strength: 'ë¦¬ë”ì‹­/ê³µê°/ì˜í–¥ë ¥', weakness: 'ê³¼í•œ ë°°ë ¤/ìê¸° ë¬´ì‹œ', love: 'ìƒëŒ€ ì„±ì¥ ë„ìš°ë©° ì‚¬ë‘. í—Œì‹ ì ì´ì§€ë§Œ ì§€ì¹  ìˆ˜ ìˆìŒ.', career: 'êµìœ¡/HR/ë¦¬ë”ì‹­ ì í•©. ì‚¬ëŒ ì„±ì¥ì‹œí‚¤ëŠ” ì¼ì— ë³´ëŒ.', action: 'ì˜¤ëŠ˜ "ë‚˜ë¥¼ ìœ„í•œ ì‹œê°„" 30ë¶„ í™•ë³´í•˜ê¸°' },
                    'ENFP': { summary: 'í™œë™ê°€ + ì—´ì •í˜•', strength: 'ì•„ì´ë””ì–´/ì‚¬êµ/ì—ë„ˆì§€', weakness: 'ì‚°ë§Œí•¨/ê¹Šì´ ë¶€ì¡±', love: 'ì„¤ë ˜ê³¼ ì—°ê²°ê° ì¶”êµ¬. ê¶Œíƒœê¸° ì˜¤ë©´ í˜ë“¤ì–´í•¨.', career: 'ë§ˆì¼€íŒ…/ê¸°íš/ì½˜í…ì¸  ì í•©. ìƒˆë¡œìš´ ê²ƒ ì‹œì‘í•˜ëŠ” í˜.', action: 'ì˜¤ëŠ˜ ì§„í–‰ ì¤‘ì¸ ì¼ 1ê°œ "ë"ê¹Œì§€ ë°€ì–´ë³´ê¸°' },
                    'ISTJ': { summary: 'í˜„ì‹¤ì£¼ì˜ì + ì±…ì„í˜•', strength: 'ì„±ì‹¤/ì²´ê³„/ì‹ ë¢°', weakness: 'ë³€í™” ê±°ë¶€/ìœµí†µì„±', love: 'ì•ˆì •ì ì´ê³  ì‹ ë¢° ê¸°ë°˜ ê´€ê³„. ë§ë³´ë‹¤ í–‰ë™ìœ¼ë¡œ í‘œí˜„.', career: 'ê´€ë¦¬/íšŒê³„/ê³µë¬´ì› ì í•©. ë§¡ì€ ì¼ í™•ì‹¤íˆ ì²˜ë¦¬.', action: 'ì˜¤ëŠ˜ "í‰ì†Œì™€ ë‹¤ë¥¸ ë°©ì‹" 1ê°œ ì‹œë„í•´ë³´ê¸°' },
                    'ISFJ': { summary: 'ìˆ˜í˜¸ì + í—Œì‹ í˜•', strength: 'ë°°ë ¤/ê¼¼ê¼¼í•¨/ì¸ë‚´', weakness: 'ìê¸° í‘œí˜„/ê±°ì ˆ', love: 'ì¡°ìš©íˆ ì±™ê¸°ëŠ” ì‚¬ë‘. í—Œì‹ í•˜ì§€ë§Œ í‘œí˜„ì€ ì„œíˆ¼.', career: 'ì˜ë£Œ/ë³µì§€/ì„œë¹„ìŠ¤ ì í•©. ì‚¬ëŒ ë•ëŠ” ì¼ì— ë³´ëŒ.', action: 'ì˜¤ëŠ˜ ë‚´ ì˜ê²¬ 1ê°œ "ë¨¼ì €" ë§í•´ë³´ê¸°' },
                    'ESTJ': { summary: 'ê²½ì˜ì + ê´€ë¦¬í˜•', strength: 'ì¡°ì§ë ¥/ì‹¤í–‰ë ¥/ì±…ì„ê°', weakness: 'ê³ ì§‘/ê°ì • ë¬´ì‹œ', love: 'ì‹¤ìš©ì  íŒŒíŠ¸ë„ˆì‹­. ì•½ì†ê³¼ ê³„íš ì¤‘ì‹œ.', career: 'ê²½ì˜/ê´€ë¦¬/ìš´ì˜ ì í•©. ì‹œìŠ¤í…œ ì¡ê³  ì‹¤í–‰í•˜ëŠ” í˜.', action: 'ì˜¤ëŠ˜ ìƒëŒ€ ê°ì • "ë¨¼ì € ë¬¼ì–´ë³´ê¸°" 1íšŒ' },
                    'ESFJ': { summary: 'ì§‘ì •ê´€ + ì‚¬êµí˜•', strength: 'ì¹œí™”ë ¥/ë°°ë ¤/ì¡°í™”', weakness: 'ê°ˆë“± íšŒí”¼/ëˆˆì¹˜', love: 'ë”°ëœ»í•˜ê³  í—Œì‹ ì . ì¸ì •ë°›ê³  ì‹¶ì€ ìš•êµ¬ ìˆìŒ.', career: 'ì„œë¹„ìŠ¤/êµìœ¡/HR ì í•©. ì‚¬ëŒê³¼ í•¨ê»˜í•˜ëŠ” ì¼.', action: 'ì˜¤ëŠ˜ "NO" í•œ ë²ˆ ì—°ìŠµí•´ë³´ê¸°' },
                    'ISTP': { summary: 'ì¥ì¸ + ë¶„ì„í˜•', strength: 'ë¬¸ì œí•´ê²°/ì‹¤ìš©/ë…ë¦½', weakness: 'ê°ì • í‘œí˜„/ì¥ê¸° ê³„íš', love: 'ììœ ë¡œìš´ ê´€ê³„ ì„ í˜¸. êµ¬ì†ì€ ì§ˆìƒ‰.', career: 'ê¸°ìˆ /ì—”ì§€ë‹ˆì–´/ìˆ˜ë¦¬ ì í•©. ì†ìœ¼ë¡œ í•´ê²°í•˜ëŠ” ì¼.', action: 'ì˜¤ëŠ˜ ê°ì • 1ê°œ ë§ë¡œ í‘œí˜„í•´ë³´ê¸°' },
                    'ISFP': { summary: 'ëª¨í—˜ê°€ + ì˜ˆìˆ í˜•', strength: 'ê°ê°/ë¯¸ì  ê°ê°/ìœ ì—°í•¨', weakness: 'ê³„íš/ìê¸°ì£¼ì¥', love: 'ëŠë‚Œê³¼ ë¶„ìœ„ê¸° ì¤‘ì‹œ. ì§„ì‹¬ì´ ëŠê»´ì§€ë©´ ê¹Šê²Œ ê°.', career: 'ì˜ˆìˆ /ë””ìì¸/íë§ ì í•©. ììœ ë¡œìš´ í™˜ê²½ì—ì„œ ë¹›ë‚¨.', action: 'ì˜¤ëŠ˜ ì›í•˜ëŠ” ê²ƒ 1ê°œ "ì§ì ‘ ìš”ì²­"í•´ë³´ê¸°' },
                    'ESTP': { summary: 'ì‚¬ì—…ê°€ + í–‰ë™í˜•', strength: 'ìˆœë°œë ¥/í˜„ì‹¤ê°ê°/ì—ë„ˆì§€', weakness: 'ì¥ê¸° ê³„íš/ì¸ë‚´', love: 'ìê·¹ì ì´ê³  ì¬ë¯¸ìˆëŠ” ê´€ê³„. ì§€ë£¨í•¨ì€ ëª» ì°¸ìŒ.', career: 'ì˜ì—…/ìŠ¤í¬ì¸ /ì°½ì—… ì í•©. í˜„ì¥ì—ì„œ ë¹›ë‚˜ëŠ” íƒ€ì….', action: 'ì˜¤ëŠ˜ "í•œ í…œí¬ ì‰¬ê³ " ìƒê°í•´ë³´ê¸°' },
                    'ESFP': { summary: 'ì—°ì˜ˆì¸ + ììœ í˜•', strength: 'ì‚¬êµ/ì—ë„ˆì§€/í˜„ì¬ ì§‘ì¤‘', weakness: 'ê¹Šì´/ê³„íšì„±', love: 'í•¨ê»˜ ìˆìœ¼ë©´ ì¦ê±°ìš´ ê´€ê³„. ë¶„ìœ„ê¸° ë©”ì´ì»¤.', career: 'ì—”í„°/ì„œë¹„ìŠ¤/ì´ë²¤íŠ¸ ì í•©. ì‚¬ëŒë“¤ ì•ì—ì„œ ë¹›ë‚¨.', action: 'ì˜¤ëŠ˜ ì¤‘ìš”í•œ ì¼ 1ê°œ "ë¯¸ë¦¬" ì¤€ë¹„í•´ë³´ê¸°' }
                };

                const ext = mbtiExtended[mbtiType] || mbtiExtended['ENFP'];

                if (mbtiAnalysis) {
                    mbtiAnalysis.innerHTML = `
                        <div style="margin-bottom:16px; padding:16px; background:#f8fafc; border-radius:12px; border-left:4px solid #667eea;">
                            <p style="font-weight:900; font-size:1.1rem; color:#4c1d95; margin-bottom:8px;">${mbtiType} : ${ext.summary}</p>
                            <p style="color:#374151; line-height:1.6;">${mbti.compatibility || ''}</p>
                            <p style="margin-top:8px; color:#374151; line-height:1.6;">${mbti.uniqueness || ''}</p>
                        </div>
                        <div class="advice-grid" style="margin-top:16px;">
                            <div class="advice-card" style="background:#f0fdf4; border-left-color:#22c55e;">
                                <h4 style="color:#16a34a;">ğŸ’ª ê°•ì </h4>
                                <p>${ext.strength}</p>
                            </div>
                            <div class="advice-card" style="background:#fef2f2; border-left-color:#ef4444;">
                                <h4 style="color:#dc2626;">âš ï¸ ì•½ì </h4>
                                <p>${ext.weakness}</p>
                            </div>
                            <div class="advice-card" style="background:#fef2f2; border-left-color:#ec4899;">
                                <h4 style="color:#db2777;">ğŸ’ ì—°ì•  ìŠ¤íƒ€ì¼</h4>
                                <p>${ext.love}</p>
                            </div>
                            <div class="advice-card" style="background:#eff6ff; border-left-color:#3b82f6;">
                                <h4 style="color:#2563eb;">ğŸ’¼ ì»¤ë¦¬ì–´ ì í•©</h4>
                                <p>${ext.career}</p>
                            </div>
                        </div>
                        <div style="margin-top:16px; padding:14px 18px; background:linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius:12px; color:white;">
                            <p style="font-weight:800;">âœ… ì˜¤ëŠ˜ ì‹¤ì²œ: ${ext.action}</p>
                        </div>
                    `;
                }
            }

            // 3) ì‹­ì‹  ë¶„ì„(ì‰¬ìš´ ìš”ì•½)
            if (sajuData && sajuData.tenGods) {
                var tg = sajuData.tenGods;
                var primary = tg.primary || 'ì •ê´€';
                var secondary = tg.secondary || 'ë¹„ê²¬';

                const tenMap = {
                    'ë¹„ê²¬': { vibe: 'ë‚´ í˜ì´ìŠ¤/ìê¸°ì£¼ë„', work: 'í˜¼ì ëª°ì…í•˜ëŠ” ì¼, ê°œì¸ ì—­ëŸ‰ ê¸°ë°˜', rel: 'ë™ë“±í•œ ê´€ê³„ì—ì„œ í¸í•¨. ê°„ì„­ ì‹«ì–´í•¨.' },
                    'ê²ì¬': { vibe: 'ìŠ¹ë¶€/ë…ë¦½/ëŒíŒŒ', work: 'ìƒˆ íŒ ì§œê¸°, ê²½ìŸ/ì˜ì—…/ì°½ì—… ê¸°ì§ˆ', rel: 'ì¿¨í•œë° ëœ¨ê±°ì›€. ìì¡´ì‹¬ ì‹¸ì›€ ì£¼ì˜.' },
                    'ì‹ì‹ ': { vibe: 'ê¾¸ì¤€í•¨/ìƒì‚°/ì‹¤í–‰', work: 'ì½˜í…ì¸ /ì œì‘/ê¸°ìˆ , ìŒ“ì•„ì˜¬ë¦¬ëŠ” ì¼', rel: 'ë°°ë ¤í˜•. í‘œí˜„ì´ í˜„ì‹¤ì .' },
                    'ìƒê´€': { vibe: 'í‘œí˜„/ê°œì„±/ì§ì„¤', work: 'ê¸°íš/ë§ˆì¼€íŒ…/í¬ë¦¬ì—ì´í‹°ë¸Œ, ë§ë¡œ ë¨¹ê³ ì‚¬ëŠ”', rel: 'ë§¤ë ¥ ê°•í•œë° íŒ©í­ ì¡°ì ˆ í•„ìš”.' },
                    'ì •ì¬': { vibe: 'ì•ˆì •/ê´€ë¦¬/í˜„ì‹¤ê°', work: 'ìš´ì˜/íšŒê³„/PM, ëˆê´€ë¦¬ ì˜í•¨', rel: 'ì‹ ë¢° ìŒ“ëŠ” ì—°ì• . ê³„íší˜•.' },
                    'í¸ì¬': { vibe: 'ê¸°íšŒ/í™•ì¥/ì‚¬êµ', work: 'ì˜ì—…/íˆ¬ì/ì‚¬ì—…, íŒ í‚¤ìš°ê¸°', rel: 'ìŠ¤ì¼€ì¼ í° ì—°ì• . ì¶©ë™ì§€ì¶œ ì£¼ì˜.' },
                    'ì •ê´€': { vibe: 'ê·œì¹™/ì±…ì„/ì„±ì‹¤', work: 'ì¡°ì§/ê³µê³µ/ë¦¬ë”ì‹­, ë§¡ì€ ì¼ ëê¹Œì§€', rel: 'ì•½ì† ì¤‘ìš”. ì•ˆì •ì ì¸ ê´€ê³„ ì„ í˜¸.' },
                    'í¸ê´€': { vibe: 'ì¹´ë¦¬ìŠ¤ë§ˆ/ê²°ë‹¨/ì••ë°•', work: 'ìœ„ê¸°ê´€ë¦¬/ìŠ¹ë¶€ì²˜ ê°•í•¨, ê°•í•œ ë¦¬ë”', rel: 'ëŒê³  ê°€ëŠ” íƒ€ì…. ê³ ì§‘/ê°•ì•• ì£¼ì˜.' },
                    'ì •ì¸': { vibe: 'í•™ìŠµ/ì •ë¦¬/ë³´í˜¸', work: 'ì—°êµ¬/ë¶„ì„/ê¸°íš, ê³µë¶€ë¡œ ì—­ì „', rel: 'ë”°ëœ»í•œë° í˜¼ì íšŒë³µ ì‹œê°„ í•„ìš”.' },
                    'í¸ì¸': { vibe: 'ì§ê°/íŠ¹ì´ì /ëª°ì…', work: 'ë…íŠ¹í•œ ì „ë¬¸ì„±, í•œë°©ì˜ ì•„ì´ë””ì–´', rel: 'ì·¨í–¥ í™•ê³ . ì´í•´ë°›ìœ¼ë©´ ê¹Šê²Œ ê°.' }
                };

                const p = tenMap[primary] || tenMap['ì •ê´€'];
                const s = tenMap[secondary] || tenMap['ë¹„ê²¬'];

                const html = `
                    <p style="font-weight:900;">ğŸ”¥ í•µì‹¬ ìºë¦­í„°: <span class="mono">${primary || 'ì •ê´€'}</span> + <span class="mono">${secondary || 'ë¹„ê²¬'}</span></p>
                    <p style="margin-top:12px; color:#374151; line-height:1.65;">
                        <strong>í•œ ì¤„ ìš”ì•½:</strong> ${p.vibe} ì„±í–¥ì´ ê¸°ë³¸ì´ê³ , ${s.vibe} ê¸°ì§ˆì´ ë³´ì¡°ë¡œ ê¹”ë ¤ìˆì–´.
                    </p>
                    <p style="margin-top:10px; color:#374151; line-height:1.65;">
                        <strong>ì¼/ì»¤ë¦¬ì–´:</strong> ${p.work}
                    </p>
                    <p style="margin-top:10px; color:#374151; line-height:1.65;">
                        <strong>ì—°ì• /ê´€ê³„:</strong> ${p.rel}
                    </p>
                    <p style="margin-top:12px; font-weight:800; color:#4c1d95;">âœ… ì•¡ì…˜íŒ: ${primary} ê¸°ìš´ì€ â€œì¥ì ì´ ê³¼í•˜ë©´ ë‹¨ì â€ì´ ë¼. ì˜¤ëŠ˜ì€ í•œ ê°€ì§€(ë§/ëˆ/ê²°ì •)ë§Œ â€˜ì¡°ì ˆâ€™í•´ë´.</p>
                `;

                const el = document.getElementById('tenGodsAnalysis');
                if (el) el.innerHTML = html;
            }

            // ìš©ì‹ /ê¸°ì‹  ë¶„ì„
            if (sajuData && sajuData.yongsinGisin) {
                const yg = sajuData.yongsinGisin;
                const yongsinEl = document.getElementById('yongsinAnalysis');
                if (yongsinEl) {
                    yongsinEl.innerHTML =
                        '<p><strong>ğŸŒŸ ìš©ì‹ (ç”¨ç¥): ' + yg.yongsin + '</strong> - ë‹¹ì‹ ì—ê²Œ ë„ì›€ì´ ë˜ëŠ” ê¸°ìš´ì…ë‹ˆë‹¤.</p>' +
                        '<p style="margin-top: 10px;"><strong>âš ï¸ ê¸°ì‹ (å¿Œç¥): ' + yg.gisin + '</strong> - ì£¼ì˜í•´ì•¼ í•  ê¸°ìš´ì…ë‹ˆë‹¤.</p>' +
                        '<p style="margin-top: 15px;">' + yg.yongsin + ' ê¸°ìš´ì„ ì ê·¹ í™œìš©í•˜ê³ , ' + yg.gisin + ' ê¸°ìš´ì€ ì ì ˆíˆ ì¡°ì ˆí•˜ì—¬ ê· í˜•ì„ ë§ì¶”ì„¸ìš”.</p>';
                }

                // ìš©ì‹  ì‹¤ì²œíŒ ì¹´ë“œ í‘œì‹œ
                const yongsinTipsData = {
                    'ëª©': { color: 'ì´ˆë¡ìƒ‰, ì²­ë¡ìƒ‰ ê³„ì—´', time: 'ì˜¤ì „ 5ì‹œ~9ì‹œ (ëª© ê¸°ìš´ ì‹œê°„)', action: 'ì˜¤ëŠ˜ í•˜ë£¨ ì‹ë¬¼ ì˜†ì—ì„œ 5ë¶„ ëª…ìƒí•˜ê±°ë‚˜, ì‚°ì±… 10ë¶„ í•´ë³´ê¸°' },
                    'í™”': { color: 'ë¹¨ê°•, ì£¼í™©, ë¶„í™ ê³„ì—´', time: 'ì˜¤ì „ 9ì‹œ~ì˜¤í›„ 1ì‹œ (í™” ê¸°ìš´ ì‹œê°„)', action: 'ì ì‹¬ ì „ì— ê°€ì¥ ì¤‘ìš”í•œ ê²°ì •/ë¯¸íŒ… ì¡ê¸°. ì—ë„ˆì§€ í”¼í¬ í™œìš©!' },
                    'í† ': { color: 'ë…¸ë‘, ë² ì´ì§€, ë¸Œë¼ìš´ ê³„ì—´', time: 'í™˜ì ˆê¸° ì‹œê°„ëŒ€ or ì‹ì‚¬ ì‹œê°„', action: 'ì˜¤ëŠ˜ ì¤‘ì‹¬ ì¡ëŠ” ë£¨í‹´(ìŠ¤íŠ¸ë ˆì¹­/ì •ë¦¬ì •ëˆ) 10ë¶„ í•˜ê¸°' },
                    'ê¸ˆ': { color: 'í°ìƒ‰, íšŒìƒ‰, ê³¨ë“œ/ì‹¤ë²„ ê³„ì—´', time: 'ì˜¤í›„ 3ì‹œ~7ì‹œ (ê¸ˆ ê¸°ìš´ ì‹œê°„)', action: 'ì˜¤ëŠ˜ ì •ë¦¬í•  ê²ƒ 1ê°œ ì„ íƒí•´ì„œ ê¹”ë”í•˜ê²Œ ë§ˆë¬´ë¦¬í•˜ê¸°' },
                    'ìˆ˜': { color: 'ê²€ì •, ë‚¨ìƒ‰, íŒŒë‘ ê³„ì—´', time: 'ë°¤ 9ì‹œ~ìƒˆë²½ 1ì‹œ (ìˆ˜ ê¸°ìš´ ì‹œê°„)', action: 'ì €ë…ì— í˜¼ì ê³µë¶€/ë…ì„œ/ì˜ìƒ ì‹œì²­ìœ¼ë¡œ ì§€ì‹ ì¶©ì „í•˜ê¸°' }
                };
                const tips = yongsinTipsData[yg.yongsin] || yongsinTipsData['í† '];

                const tipsSection = document.getElementById('yongsinTipsSection');
                const colorText = document.getElementById('yongsinColorText');
                const timeText = document.getElementById('yongsinTimeText');
                const actionText = document.getElementById('yongsinActionText');

                if (tipsSection) tipsSection.style.display = 'block';
                if (colorText) colorText.textContent = tips.color;
                if (timeText) timeText.textContent = tips.time;
                if (actionText) actionText.textContent = tips.action;
            }

            // ë§ì¶¤ ì¡°ì–¸
            var loveAdv = (analysisData && analysisData.compatibilityAnalysis && analysisData.compatibilityAnalysis.romantic && analysisData.compatibilityAnalysis.romantic.general)
                ? analysisData.compatibilityAnalysis.romantic.general
                : 'ì„œë¡œì˜ ì°¨ì´ì ì„ ì¸ì •í•˜ê³  ì¡´ì¤‘í•˜ëŠ” ê´€ê³„ê°€ ì¢‹ìŠµë‹ˆë‹¤.';
            safeSetText('loveAdvice', loveAdv);
            
            var careerAdv = (analysisData && analysisData.careerGuidance && analysisData.careerGuidance.aptitude)
                ? analysisData.careerGuidance.aptitude.substring(0, 100)
                : 'ê¾¸ì¤€í•œ ë…¸ë ¥ê³¼ ë°œì „ì´ ì¢‹ì€ ê²°ê³¼ë¥¼ ê°€ì ¸ì˜¬ ê²ƒì…ë‹ˆë‹¤.';
            safeSetText('careerAdvice', careerAdv);
            
            safeSetText('wealthAdvice', 'ê³„íšì ì¸ ì¬ì • ê´€ë¦¬ì™€ ì‹ ì¤‘í•œ íˆ¬ìë¥¼ ê¶Œì¥í•©ë‹ˆë‹¤.');
            
            var healthAdv = (analysisData && analysisData.healthAnalysis && analysisData.healthAnalysis.recommendations && analysisData.healthAnalysis.recommendations.lifestyle)
                ? analysisData.healthAnalysis.recommendations.lifestyle
                : 'ê·œì¹™ì ì¸ ìƒí™œê³¼ ì ì ˆí•œ ìš´ë™ìœ¼ë¡œ ê±´ê°•ì„ ìœ ì§€í•˜ì„¸ìš”.';
            safeSetText('healthAdvice', healthAdv);
        }

        // í´ë°± ê²°ê³¼ (ì—”ì§„ ë¡œë“œ ì‹¤íŒ¨ì‹œ)
        function displayFallbackResults(userData) {
            safeSetText('reportTitle', (userData.name || '') + 'ë‹˜ì˜ ì‚¬ì£¼ ë¶„ì„ ê²°ê³¼');
            safeSetText('userInfo',
                (userData.gender === 'M' ? 'ë‚¨ì„±' : 'ì—¬ì„±') + ' Â· ' +
                userData.year + 'ë…„ ' + userData.month + 'ì›” ' + userData.day + 'ì¼ìƒ');

            // ê¸°ë³¸ ì ìˆ˜
            const baseScore = ((userData.year || 0) + (userData.month || 0) + (userData.day || 0)) % 20 + 75;
            safeSetText('totalScore', baseScore);
            safeSetText('headerLoveScore', baseScore - 2);
            safeSetText('headerCareerScore', baseScore + 1);
            safeSetText('headerWealthScore', baseScore - 1);

            safeSetText('loveScore', baseScore - 2);
            safeSetText('careerScore', baseScore + 1);
            safeSetText('wealthScore', baseScore - 1);
            safeSetText('healthScore', baseScore);

            safeSetHTML('personalityAnalysis',
                '<p>ë‹¹ì‹ ì€ ë…íŠ¹í•œ ë§¤ë ¥ê³¼ ì ì¬ë ¥ì„ ê°€ì§„ ë¶„ì…ë‹ˆë‹¤. ìì‹ ë§Œì˜ ê°•ì ì„ ë°œíœ˜í•˜ì—¬ ëª©í‘œë¥¼ í–¥í•´ ë‚˜ì•„ê°€ì„¸ìš”.</p>');
        }

        // ê²°ê³¼ ê³µìœ 
        function shareResult() {
            const url = window.location.href;
            
            if (navigator.share) {
                navigator.share({
                    title: 'ğŸ”® AI ì‚¬ì£¼ Ã— MBTI ë¶„ì„ ê²°ê³¼',
                    text: 'ë‚˜ì˜ ì‚¬ì£¼ ë¶„ì„ ê²°ê³¼ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!',
                    url: url
                }).catch(function() {
                    copyToClipboard(url);
                });
            } else {
                copyToClipboard(url);
            }
        }

        function copyToClipboard(text) {
            if (navigator.clipboard) {
                navigator.clipboard.writeText(text).then(function() {
                    alert('ğŸ“‹ ë§í¬ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
                });
            } else {
                prompt('ë§í¬ë¥¼ ë³µì‚¬í•˜ì„¸ìš”:', text);
            }
        }
    </script>
</body>
</html>
